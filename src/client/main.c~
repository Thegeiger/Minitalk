/*
** main.c for serv in /home/geiger_a/rendu/PSU_2014_minitalk/src/client
**
** Made by anthony geiger
** Login   <geiger_a@epitech.net>
**
** Started on  Tue Feb 24 10:34:44 2015 anthony geiger
** Last update Wed Feb 25 11:51:10 2015 anthony geiger
*/

#include <sys/types.h>
#include <signal.h>
#include "my.h"
#include <unistd.h>

int	main(int argc, char **argv)
{
  int	pid;
  int	i;
  int	n;
  char	c;

  i = 0;
  if (argc != 3)
    {
      my_putstr("to few argument\n");
      return (2);
    }
  pid = my_getnb(argv[1]);
  while (argv[2][i])
    {
      n = 0;
      c = argv[2][i];
      while (n != 8)
	{
	  if ((c & (0b10000000) >> n) & (0b10000000 >> n))
	    {
	      my_putchar('1');
	      kill(pid, SIGUSR1);
	    }
	  else
	    {
	      my_putchar('0');
	      kill(pid, SIGUSR2);
	    }
	  usleep(5);
	  n++;
	}
	  my_putchar('\n');
      i++;
    }
  return (0);
}
